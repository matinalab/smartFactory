# æ™ºæ…§å·¥å‚ç›‘æ§ç³»ç»Ÿ (SmartFactory)

ä¸€ä¸ªåŸºäº Vue 3 + Nest.js çš„å…¨æ ˆæ™ºæ…§å·¥å‚å¯è§†åŒ–ç›‘æ§ç³»ç»Ÿï¼Œæä¾›å®æ—¶è®¾å¤‡çŠ¶æ€ç›‘æ§ã€å‘Šè­¦ç®¡ç†ã€æ•°æ®ç»Ÿè®¡ç­‰åŠŸèƒ½ã€‚

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ™ºæ…§å·¥å‚ç›‘æ§è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«å‰ç«¯å¯è§†åŒ–ç•Œé¢å’Œåç«¯APIæœåŠ¡ã€‚ç³»ç»Ÿé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œæ”¯æŒè®¾å¤‡å®æ—¶ç›‘æ§ã€3Dæ¨¡å‹å±•ç¤ºã€åŠ¨ç”»äº¤äº’ã€å‘Šè­¦æ¨é€ç­‰åŠŸèƒ½ã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### å‰ç«¯åŠŸèƒ½
- ğŸ­ **å·¥å‚å¹³é¢å›¾å¯è§†åŒ–**ï¼šSVGæ¸²æŸ“å·¥å‚å¸ƒå±€ï¼Œæ”¯æŒæ‹–æ‹½å’Œç¼©æ”¾
- ğŸ“Š **å®æ—¶æ•°æ®ç›‘æ§**ï¼šè®¾å¤‡çŠ¶æ€ã€æ•ˆç‡ã€æ¸©åº¦ç­‰å…³é”®æŒ‡æ ‡å®æ—¶å±•ç¤º
- ğŸš¨ **å‘Šè­¦ç³»ç»Ÿ**ï¼šå®æ—¶å‘Šè­¦æé†’ï¼Œæ”¯æŒå‘Šè­¦çº§åˆ«åˆ†ç±»
- ğŸ¨ **3Dè®¾å¤‡æ¨¡å‹**ï¼šåŸºäºThree.jsçš„è®¾å¤‡3Då¯è§†åŒ–
- ğŸ”„ **è®¾å¤‡æ§åˆ¶**ï¼šå¯åŠ¨ã€åœæ­¢ã€é‡å¯ç­‰è®¾å¤‡è¿œç¨‹æ§åˆ¶
- ğŸ¬ **æµç•…åŠ¨ç”»**ï¼šåŸºäºGSAPçš„è®¾å¤‡è¿è¡ŒåŠ¨ç”»æ•ˆæœ
- ğŸ“ˆ **æ•°æ®ç»Ÿè®¡**ï¼šè®¾å¤‡æ•ˆç‡ã€è¿è¡ŒçŠ¶æ€ç»Ÿè®¡åˆ†æ

### åç«¯åŠŸèƒ½
- ğŸ”Œ **RESTful API**ï¼šå®Œæ•´çš„è®¾å¤‡ç®¡ç†ã€å‘Šè­¦ã€ç»Ÿè®¡API
- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**ï¼šåŸºäºTypeORMçš„MySQLæ•°æ®å­˜å‚¨
- ğŸ”„ **è‡ªåŠ¨åŒæ­¥**ï¼šæ•°æ®åº“ç»“æ„è‡ªåŠ¨åŒæ­¥
- ğŸŒ± **æ•°æ®åˆå§‹åŒ–**ï¼šSeederè‡ªåŠ¨åˆå§‹åŒ–å·¥å‚æ•°æ®
- ğŸ“ **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### å‰ç«¯
- **æ¡†æ¶**: Vue 3.4.31 (Composition API)
- **æ„å»ºå·¥å…·**: Vite 5.3.4
- **è·¯ç”±**: Vue Router 4.4.0
- **çŠ¶æ€ç®¡ç†**: Pinia 2.1.7
- **HTTPå®¢æˆ·ç«¯**: Axios 1.13.0
- **3Dæ¸²æŸ“**: Three.js 0.150.1
- **åŠ¨ç”»åº“**: GSAP 3.12.5
- **æ ·å¼**: Sass 1.77.8

### åç«¯
- **æ¡†æ¶**: Nest.js 11.1.8
- **æ•°æ®åº“**: MySQL 5.7+
- **ORM**: TypeORM 0.3.27
- **è¯­è¨€**: TypeScript 5.9.3
- **è¿è¡Œæ—¶**: Node.js 16.x+

## ğŸ“ é¡¹ç›®ç»“æ„

```
smartFactory/
â”œâ”€â”€ frontend/                 # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/
â”‚   â”‚   â”‚   â””â”€â”€ smartFactory/ # ä¸»æ¨¡å—
â”‚   â”‚   â”‚       â”œâ”€â”€ components/    # ç»„ä»¶
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ AreaComp.vue
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ DeviceComp.vue
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ Device3DModal.vue
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ factoryFloorPlan.vue
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚       â”œâ”€â”€ composables/   # ç»„åˆå¼å‡½æ•°
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ useArea.js
â”‚   â”‚   â”‚       â”‚   â”œâ”€â”€ useDevice.js
â”‚   â”‚   â”‚       â”‚   â””â”€â”€ ...
â”‚   â”‚   â”‚       â””â”€â”€ index.vue      # ä¸»é¡µé¢
â”‚   â”‚   â”œâ”€â”€ api/              # APIå°è£…
â”‚   â”‚   â”œâ”€â”€ assets/           # èµ„æºæ–‡ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ devices/      # è®¾å¤‡SVGå›¾æ ‡
â”‚   â”‚   â”‚   â””â”€â”€ model/        # 3Dæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ router/           # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ store/            # PiniaçŠ¶æ€ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ styles/           # å…¨å±€æ ·å¼
â”‚   â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ vite.config.js
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ backend/                  # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ modules/          # ä¸šåŠ¡æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ factory/      # å·¥å‚èšåˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ areas/        # åŒºåŸŸç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ devices/      # è®¾å¤‡ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ connections/  # è¿æ¥çº¿ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ alerts/       # å‘Šè­¦ç³»ç»Ÿ
â”‚   â”‚   â”‚   â””â”€â”€ stats/        # ç»Ÿè®¡æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ database/         # æ•°æ®åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ entities/     # å®ä½“å®šä¹‰
â”‚   â”‚   â”‚   â””â”€â”€ seeders/      # æ•°æ®ç§å­
â”‚   â”‚   â”œâ”€â”€ config/           # é…ç½®
â”‚   â”‚   â”œâ”€â”€ common/           # å…¬å…±æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ app.module.ts
â”‚   â”‚   â””â”€â”€ main.ts
â”‚   â”œâ”€â”€ .env.example          # ç¯å¢ƒé…ç½®æ¨¡æ¿
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ tsconfig.json
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 16.x
- npm >= 8.x æˆ– yarn >= 1.22.x
- MySQL >= 5.7

### 1. å…‹éš†é¡¹ç›®

```bash
# å¦‚æœæ˜¯ä»è¿œç¨‹ä»“åº“å…‹éš†
git clone <repository-url>
cd smartFactory
```

### 2. å‰ç«¯å®‰è£…ä¸å¯åŠ¨

```bash
# è¿›å…¥å‰ç«¯ç›®å½•
cd frontend

# å®‰è£…ä¾èµ–
npm install

# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
npm run build
```

å‰ç«¯æœåŠ¡å°†è¿è¡Œåœ¨ `http://localhost:8080`

### 3. åç«¯å®‰è£…ä¸é…ç½®

```bash
# è¿›å…¥åç«¯ç›®å½•
cd backend

# å®‰è£…ä¾èµ–
npm install

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“è¿æ¥ä¿¡æ¯
```

**ç¯å¢ƒå˜é‡é…ç½® (.env)**ï¼š
```env
# æ•°æ®åº“é…ç½®
DB_HOST=localhost
DB_PORT=3306
DB_USERNAME=root
DB_PASSWORD=your_password
DB_DATABASE=smartfactory_db

# æœåŠ¡ç«¯å£
PORT=3000

# è·¨åŸŸé…ç½®
CORS_ORIGIN=http://localhost:8080
```

### 4. åˆ›å»ºæ•°æ®åº“

åœ¨ MySQL ä¸­åˆ›å»ºæ•°æ®åº“ï¼š

```sql
CREATE DATABASE smartfactory_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 5. åˆå§‹åŒ–æ•°æ®

è¿è¡Œ Seeder å¯¼å…¥åˆå§‹å·¥å‚æ•°æ®ï¼š

```bash
cd backend
npm run seed
```

### 6. å¯åŠ¨åç«¯æœåŠ¡

```bash
cd backend

# å¼€å‘æ¨¡å¼
npm run start:dev

# ç”Ÿäº§æ¨¡å¼
npm run build
npm start
```

åç«¯æœåŠ¡å°†è¿è¡Œåœ¨ `http://localhost:3000`ï¼ŒAPIå‰ç¼€ä¸º `/api`

### 7. è®¿é—®ç³»ç»Ÿ

æµè§ˆå™¨æ‰“å¼€ `http://localhost:8080` å³å¯è®¿é—®æ™ºæ…§å·¥å‚ç›‘æ§ç³»ç»Ÿã€‚

## ğŸ“¡ APIæ¥å£è¯´æ˜

### å·¥å‚æ•°æ®
- `GET /api/factory/data` - è·å–å®Œæ•´å·¥å‚æ•°æ®

### åŒºåŸŸç®¡ç†
- `GET /api/areas` - è·å–æ‰€æœ‰åŒºåŸŸ
- `GET /api/areas/:id` - è·å–å•ä¸ªåŒºåŸŸ
- `POST /api/areas` - åˆ›å»ºåŒºåŸŸ
- `PUT /api/areas/:id` - æ›´æ–°åŒºåŸŸ
- `DELETE /api/areas/:id` - åˆ é™¤åŒºåŸŸ

### è®¾å¤‡ç®¡ç†
- `GET /api/devices` - è·å–æ‰€æœ‰è®¾å¤‡
- `GET /api/devices/:id` - è·å–å•ä¸ªè®¾å¤‡
- `POST /api/devices` - åˆ›å»ºè®¾å¤‡
- `PUT /api/devices/:id` - æ›´æ–°è®¾å¤‡
- `DELETE /api/devices/:id` - åˆ é™¤è®¾å¤‡
- `POST /api/devices/:id/control` - æ§åˆ¶è®¾å¤‡ï¼ˆå¯åŠ¨/åœæ­¢/é‡å¯ï¼‰
- `GET /api/devices/:id/logs` - è·å–è®¾å¤‡æ—¥å¿—

### è¿æ¥çº¿ç®¡ç†
- `GET /api/connections` - è·å–æ‰€æœ‰è¿æ¥çº¿
- `POST /api/connections` - åˆ›å»ºè¿æ¥çº¿
- `PUT /api/connections/:id` - æ›´æ–°è¿æ¥çº¿
- `DELETE /api/connections/:id` - åˆ é™¤è¿æ¥çº¿

### å‘Šè­¦ç³»ç»Ÿ
- `GET /api/alerts` - è·å–æ‰€æœ‰å‘Šè­¦
- `GET /api/alerts/recent` - è·å–æœ€è¿‘ä¸€å°æ—¶å‘Šè­¦
- `GET /api/alerts/stats` - è·å–å‘Šè­¦ç»Ÿè®¡
- `POST /api/alerts` - åˆ›å»ºå‘Šè­¦
- `PUT /api/alerts/:id/read` - æ ‡è®°å‘Šè­¦å·²è¯»
- `DELETE /api/alerts/:id` - åˆ é™¤å‘Šè­¦
- `POST /api/alerts/generator/start` - å¯åŠ¨å‘Šè­¦ç”Ÿæˆå™¨
- `POST /api/alerts/generator/stop` - åœæ­¢å‘Šè­¦ç”Ÿæˆå™¨
- `GET /api/alerts/generator/status` - è·å–ç”Ÿæˆå™¨çŠ¶æ€
- `DELETE /api/alerts/generator/clear` - æ¸…ç©ºæ‰€æœ‰å‘Šè­¦

### ç»Ÿè®¡æ•°æ®
- `GET /api/stats` - è·å–ç»Ÿè®¡æ•°æ®

## ğŸ¨ åŠŸèƒ½äº®ç‚¹

### 1. æ‹–æ‹½å¼å·¥å‚å¸ƒå±€
- æ”¯æŒè®¾å¤‡æ‹–æ‹½ç§»åŠ¨
- è‡ªåŠ¨è¿æ¥çº¿ç»˜åˆ¶
- ç½‘æ ¼å¸é™„å¯¹é½

### 2. è®¾å¤‡3Då¯è§†åŒ–
- Three.jsæ¸²æŸ“3Dæ¨¡å‹
- æ”¯æŒæ¨¡å‹æ—‹è½¬æŸ¥çœ‹
- å®æ—¶çŠ¶æ€é¢œè‰²æ ‡è¯†

### 3. æµç•…åŠ¨ç”»æ•ˆæœ
- å‰è½¦è‡ªåŠ¨è¿è¾“åŠ¨ç”»
- ä¼ é€å¸¦ç‰©æ–™æµåŠ¨
- è®¾å¤‡è¿è¡ŒçŠ¶æ€åŠ¨ç”»

### 4. å®æ—¶æ•°æ®æ›´æ–°
- WebSocketæˆ–è½®è¯¢æ›´æ–°
- è®¾å¤‡çŠ¶æ€å®æ—¶åŒæ­¥
- å‘Šè­¦å³æ—¶æ¨é€

## ğŸ”§ å¼€å‘æŒ‡å—

### å‰ç«¯å¼€å‘

#### æ·»åŠ æ–°ç»„ä»¶
åœ¨ `frontend/src/views/smartFactory/components/` ç›®å½•ä¸‹åˆ›å»ºæ–°ç»„ä»¶ï¼š

```vue
<template>
  <div class="my-component">
    <!-- ç»„ä»¶å†…å®¹ -->
  </div>
</template>

<script setup>
// ç»„ä»¶é€»è¾‘
</script>

<style scoped>
/* ç»„ä»¶æ ·å¼ */
</style>
```

#### æ·»åŠ æ–°API
åœ¨ `frontend/src/api/factory.js` ä¸­æ·»åŠ æ–°çš„APIæ–¹æ³•ï¼š

```javascript
export const myApi = {
  getData() {
    return request({
      url: '/my-endpoint',
      method: 'get'
    })
  }
}
```

### åç«¯å¼€å‘

#### åˆ›å»ºæ–°æ¨¡å—
ä½¿ç”¨ Nest CLI åˆ›å»ºæ–°æ¨¡å—ï¼š

```bash
cd backend
nest g module myModule
nest g controller myModule
nest g service myModule
```

#### æ·»åŠ æ–°å®ä½“
åœ¨ `backend/src/database/entities/` ç›®å½•ä¸‹åˆ›å»ºæ–°å®ä½“ï¼š

```typescript
import { Entity, Column, PrimaryGeneratedColumn } from 'typeorm';

@Entity('my_table')
export class MyEntity {
  @PrimaryGeneratedColumn()
  id: number;

  @Column()
  name: string;
}
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **é¦–æ¬¡è¿è¡Œå¿…é¡»å…ˆåˆ›å»ºæ•°æ®åº“**
2. **ç¡®ä¿MySQLæœåŠ¡æ­£åœ¨è¿è¡Œ**
3. **ä¿®æ”¹ `.env` æ–‡ä»¶é…ç½®æ•°æ®åº“è¿æ¥**
4. **å¼€å‘ç¯å¢ƒ `synchronize: true` ä¼šè‡ªåŠ¨åŒæ­¥æ•°æ®åº“ç»“æ„**
5. **ç”Ÿäº§ç¯å¢ƒå»ºè®® `synchronize: false` ä½¿ç”¨è¿ç§»ç®¡ç†**
6. **å‰ç«¯å¼€å‘æ—¶ç¡®ä¿åç«¯æœåŠ¡å·²å¯åŠ¨**

## ğŸ› æ•…éšœæ’æŸ¥

### å‰ç«¯å¯åŠ¨å¤±è´¥
- æ£€æŸ¥ Node.js ç‰ˆæœ¬æ˜¯å¦ >= 16
- åˆ é™¤ `node_modules` é‡æ–°å®‰è£…ä¾èµ–
- æ£€æŸ¥ç«¯å£ 8080 æ˜¯å¦è¢«å ç”¨

### åç«¯è¿æ¥æ•°æ®åº“å¤±è´¥
- æ£€æŸ¥ MySQL æœåŠ¡æ˜¯å¦å¯åŠ¨
- æ£€æŸ¥ `.env` é…ç½®æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å·²åˆ›å»º
- æ£€æŸ¥æ•°æ®åº“ç”¨æˆ·æƒé™

### APIè¯·æ±‚å¤±è´¥
- æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦å¯åŠ¨
- æ£€æŸ¥ Vite ä»£ç†é…ç½®
- æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°ç½‘ç»œè¯·æ±‚
- æŸ¥çœ‹åç«¯æ§åˆ¶å°æ—¥å¿—

## ğŸ“¦ éƒ¨ç½²

### å‰ç«¯éƒ¨ç½²
```bash
cd frontend
npm run build
# å°† dist ç›®å½•éƒ¨ç½²åˆ°é™æ€æœåŠ¡å™¨ï¼ˆNginxã€Apacheç­‰ï¼‰
```

### åç«¯éƒ¨ç½²
```bash
cd backend
npm run build
# ä½¿ç”¨ PM2 æˆ–å…¶ä»–è¿›ç¨‹ç®¡ç†å·¥å…·å¯åŠ¨
pm2 start dist/main.js --name smartfactory-api
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ License

ISC

## ğŸ‘¨â€ğŸ’» ä½œè€…

SmartFactory Team

---

**æŠ€æœ¯æ”¯æŒ**: å¦‚æœ‰é—®é¢˜ï¼Œè¯·æäº¤ Issue æˆ–è”ç³»å¼€å‘å›¢é˜Ÿã€‚


